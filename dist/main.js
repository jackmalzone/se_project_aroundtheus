!function(){"use strict";class e{constructor(e,t,s){this._place=e.place,this._link=e.link,this._alt=e.alt,this._cardSelector=t,this._handleImageClick=s}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._handleLikeButton()})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteButton()})),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this._link,this._alt,this._place)}))}_handleLikeButton(){this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")}_handleDeleteButton(){this._cardElement.remove(),this._cardElement=null}getView(){const e=document.querySelector(this._cardSelector);this._cardElement=e.content.firstElementChild.cloneNode(!0);const t=this._cardElement.querySelector(".card__image"),s=this._cardElement.querySelector(".card__caption");return t.src=this._link,t.alt=this._alt,s.textContent=this._place,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._settings=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._submitButton=this._formElement.querySelector(this._settings.submitButtonSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._settings.inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.textContent="",t.classList.remove(this._settings.errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this.disableButton():(this._submitButton.classList.remove(this._settings.inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))})),this._toggleButtonState()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._toggleButtonState()}disableButton(){this._submitButton.classList.add(this._settings.inactiveButtonClass),this._submitButton.disabled=!0}}class s{constructor(e){this._popupElement=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this),this._handleMouseDown=this._handleMouseDown.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this._isMouseDownOnModal=!1}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleMouseDown(e){e.target.classList.contains("modal_opened")?this._isMouseDownOnModal=!0:this._isMouseDownOnModal=!1}_handleMouseUp(e){this._isMouseDownOnModal&&e.target.classList.contains("modal_opened")&&this.close(e.target),this._isMouseDownOnModal=!1}setEventListeners(){this._popupElement.addEventListener("mousedown",this._handleMouseDown),this._popupElement.addEventListener("mouseup",this._handleMouseUp),this._popupElement.querySelector(".modal__close").addEventListener("click",(()=>this.close()))}}document.querySelector("#card-template").content;const n=document.querySelector("#profile-edit-modal"),o=document.querySelector("#profile-add-modal"),i=document.querySelector("#profile-preview-modal"),r=n.querySelector(".modal__form"),a=o.querySelector(".modal__form"),l=(document.querySelector(".cards__list"),document.querySelector("#profile-edit-button")),c=(n.querySelector("#modal-button-close"),o.querySelector("#modal-button-close"),document.querySelector("#profile-add-button"));i.querySelector("#modal-button-close"),i.querySelector(".modal__image"),i.querySelector(".modal__heading");const u=document.querySelector("#modal-input-name"),d=document.querySelector("#modal-input-description"),m=a.querySelector("#modal-input-place"),h=a.querySelector("#modal-input-link"),_={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__submit-button_inactive",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"};class p extends s{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputs=Array.from(this._popupForm.querySelectorAll(".modal__input"))}_getInputValues(){return this._inputValues={},this._inputs.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setEventListeners(){super.setEventListeners(),this._popupForm.removeEventListener("submit",this._submitHandler),this._submitHandler=e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()},this._popupForm.addEventListener("submit",this._submitHandler)}close(){super.close(),this._popupForm.reset()}}const g=new t(_,r),E=new t(_,a);g.enableValidation(),E.enableValidation();const v=new class{constructor(e){let{nameSelector:t,jobSelector:s}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent}}setUserInfo(e){let{name:t,job:s}=e;this._nameElement.textContent=t,this._jobElement.textContent=s}}({nameSelector:"#profile-name",jobSelector:"#profile-description"}),f=new p("#profile-edit-modal",(function(){console.log("Edit form submit handler called"),console.log("Name:",u.value),console.log("Description:",d.value),v.setUserInfo({name:u.value,job:d.value}),r.reset(),g.resetValidation(),g.disableButton(),f.close()})),w=new p("#profile-add-modal",(function(){const e=b({place:m.value,link:h.value,alt:`Image of ${m.value}`});S.addItem(e),a.reset(),E.resetValidation(),E.disableButton(),w.close()})),y=new class extends s{constructor(e){super(e),this._image=this._popupElement.querySelector(".modal__image"),this._place=this._popupElement.querySelector(".modal__heading_type_preview")}open(e,t,s){this._image.src=e,this._image.alt=t,this._place.textContent=s,super.open()}}("#profile-preview-modal");f.setEventListeners(),w.setEventListeners(),y.setEventListeners();const S=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{place:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg",alt:"Sunset view of Yosemite Valley with El Capitan visible, river flowing in the foreground surrounded by dense pine trees."},{place:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg",alt:"Calm waters of Lake Louise reflecting the surrounding mountains under a soft blue sky."},{place:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg",alt:"Sunburst peaking over the silhouette of the Bald Mountains at sunrise, casting a warm glow across the hazy, layered ridges."},{place:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg",alt:"Starry night sky over the jagged peaks of Latemar mountain range with remnants of snow highlighting its rugged terrain."},{place:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg",alt:"Twilight hues casting a soft glow on the peaks of Vanoise National Park, reflected in the still waters of a mountain lake."},{place:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg",alt:"Wooden boats moored at a dock on Lago di Braies with towering Dolomite mountains reflecting in the crystal-clear lake water."}],renderer:e=>{const t=b(e);S.addItem(t)}},".cards__list");function b(t){return new e(t,"#card-template",L).getView()}function L(e,t,s){y.open(e,t,s)}l.addEventListener("click",(()=>{const e=v.getUserInfo();console.log("Edit Button Clicked - User Data:",e),u.value=e.name,d.value=e.job,g.resetValidation(),f.open()})),c.addEventListener("click",(()=>{E.resetValidation(),a.reset(),E.disableButton(),w.open()})),S.renderItems()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXdCZSxNQUFRbUMsRUFBU3ZCLElBRXpDVCxFQUF5QjNDLGtCQUN6QnVELEVBQWlCOUMsTUFBTSxJQUd6QmMsRUFBaUJ6RSxpQkFBaUIsU0FBUyxLQUN6QzhGLEVBQXdCNUMsa0JBQ3hCcUIsRUFBZXFCLFFBQ2ZFLEVBQXdCbkQsZ0JBQ3hCaUUsRUFBZ0JqRCxNQUFNLElBSXhCb0QsRUFBWVUsYSIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKGRhdGEsIGNhcmRTZWxlY3RvciwgaGFuZGxlSW1hZ2VDbGljaykge1xuICAgIHRoaXMuX3BsYWNlID0gZGF0YS5wbGFjZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2FsdCA9IGRhdGEuYWx0O1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XG4gICAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKCk7XG4gICAgICB9KTtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbGluaywgdGhpcy5fYWx0LCB0aGlzLl9wbGFjZSk7XG4gICAgICB9KTtcbiAgfVxuXG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gIH1cblxuICBfaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgLy8gZ2V0IGNhcmQgdmlld1xuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgY29uc3QgY2FyZENhcHRpb24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2NhcHRpb25cIik7XG5cbiAgICBjYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICBjYXJkSW1hZ2UuYWx0ID0gdGhpcy5fYWx0O1xuICAgIGNhcmRDYXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5fcGxhY2U7XG5cbiAgICAvLyBzZXQgZXZlbnQgbGlzdGVuZXJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgLy8gcmV0dXJuIGNhcmRcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLl9zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICB0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gIH1cblxuICAvLyBQUklWQVRFIE1FVEhPRFNcblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKTtcbiAgfVxuXG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICAvLyBQVUJMSUMgTUVUSE9EU1xuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIC8vIGNvbnNvbGUubG9nKFwiUG9wdXAgc2VsZWN0b3I6XCIsIHBvcHVwU2VsZWN0b3IpOyAvLyBEZWJ1Z2dpbmcgbGluZVxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgLy8gY29uc29sZS5sb2coXCJQb3B1cCBlbGVtZW50OlwiLCB0aGlzLl9wb3B1cEVsZW1lbnQpOyAvLyBEZWJ1Z2dpbmcgbGluZVxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVNb3VzZURvd24gPSB0aGlzLl9oYW5kbGVNb3VzZURvd24uYmluZCh0aGlzKTtcbiAgICB0aGlzLl9oYW5kbGVNb3VzZVVwID0gdGhpcy5faGFuZGxlTW91c2VVcC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX2lzTW91c2VEb3duT25Nb2RhbCA9IGZhbHNlO1xuICB9XG5cbiAgLy8gT3RoZXIgbWV0aG9kcy4uLlxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVNb3VzZURvd24oZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgdGhpcy5faXNNb3VzZURvd25Pbk1vZGFsID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faXNNb3VzZURvd25Pbk1vZGFsID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZU1vdXNlVXAoZXZlbnQpIHtcbiAgICBpZiAoXG4gICAgICB0aGlzLl9pc01vdXNlRG93bk9uTW9kYWwgJiZcbiAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIilcbiAgICApIHtcbiAgICAgIHRoaXMuY2xvc2UoZXZlbnQudGFyZ2V0KTtcbiAgICB9XG4gICAgdGhpcy5faXNNb3VzZURvd25Pbk1vZGFsID0gZmFsc2U7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVNb3VzZURvd24pO1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLl9oYW5kbGVNb3VzZVVwKTtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICB9XG59XG4iLCJpbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5cbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBwbGFjZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gICAgYWx0OiBcIlN1bnNldCB2aWV3IG9mIFlvc2VtaXRlIFZhbGxleSB3aXRoIEVsIENhcGl0YW4gdmlzaWJsZSwgcml2ZXIgZmxvd2luZyBpbiB0aGUgZm9yZWdyb3VuZCBzdXJyb3VuZGVkIGJ5IGRlbnNlIHBpbmUgdHJlZXMuXCIsXG4gIH0sXG4gIHtcbiAgICBwbGFjZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgICBhbHQ6IFwiQ2FsbSB3YXRlcnMgb2YgTGFrZSBMb3Vpc2UgcmVmbGVjdGluZyB0aGUgc3Vycm91bmRpbmcgbW91bnRhaW5zIHVuZGVyIGEgc29mdCBibHVlIHNreS5cIixcbiAgfSxcbiAge1xuICAgIHBsYWNlOiBcIkJhbGQgTW91bnRhaW5zXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxuICAgIGFsdDogXCJTdW5idXJzdCBwZWFraW5nIG92ZXIgdGhlIHNpbGhvdWV0dGUgb2YgdGhlIEJhbGQgTW91bnRhaW5zIGF0IHN1bnJpc2UsIGNhc3RpbmcgYSB3YXJtIGdsb3cgYWNyb3NzIHRoZSBoYXp5LCBsYXllcmVkIHJpZGdlcy5cIixcbiAgfSxcbiAge1xuICAgIHBsYWNlOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgICBhbHQ6IFwiU3RhcnJ5IG5pZ2h0IHNreSBvdmVyIHRoZSBqYWdnZWQgcGVha3Mgb2YgTGF0ZW1hciBtb3VudGFpbiByYW5nZSB3aXRoIHJlbW5hbnRzIG9mIHNub3cgaGlnaGxpZ2h0aW5nIGl0cyBydWdnZWQgdGVycmFpbi5cIixcbiAgfSxcbiAge1xuICAgIHBsYWNlOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxuICAgIGFsdDogXCJUd2lsaWdodCBodWVzIGNhc3RpbmcgYSBzb2Z0IGdsb3cgb24gdGhlIHBlYWtzIG9mIFZhbm9pc2UgTmF0aW9uYWwgUGFyaywgcmVmbGVjdGVkIGluIHRoZSBzdGlsbCB3YXRlcnMgb2YgYSBtb3VudGFpbiBsYWtlLlwiLFxuICB9LFxuICB7XG4gICAgcGxhY2U6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgICBhbHQ6IFwiV29vZGVuIGJvYXRzIG1vb3JlZCBhdCBhIGRvY2sgb24gTGFnbyBkaSBCcmFpZXMgd2l0aCB0b3dlcmluZyBEb2xvbWl0ZSBtb3VudGFpbnMgcmVmbGVjdGluZyBpbiB0aGUgY3J5c3RhbC1jbGVhciBsYWtlIHdhdGVyLlwiLFxuICB9LFxuXTtcblxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50O1xuXG4vLyBFbGVtZW50c1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLW1vZGFsXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVQcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLXByZXZpZXctbW9kYWxcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEZvcm0gPSBwcm9maWxlQWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmV4cG9ydCBjb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5cbi8vIEJ1dHRvbnNcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbkNsb3NlID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNtb2RhbC1idXR0b24tY2xvc2VcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlQWRkQnV0dG9uQ2xvc2UgPSBwcm9maWxlQWRkTW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjbW9kYWwtYnV0dG9uLWNsb3NlXCJcbik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVQcmV2aWV3QnV0dG9uQ2xvc2UgPSBwcm9maWxlUHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsLWJ1dHRvbi1jbG9zZVwiXG4pO1xuZXhwb3J0IGxldCBpc01vdXNlRG93bk9uTW9kYWwgPSBmYWxzZTtcblxuLy8gUHJvZmlsZSBEYXRhXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBcIiNwcm9maWxlLW5hbWVcIjtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBcIiNwcm9maWxlLWRlc2NyaXB0aW9uXCI7XG5leHBvcnQgY29uc3QgY2FyZFByZXZpZXdJbWFnZSA9XG4gIHByb2ZpbGVQcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5leHBvcnQgY29uc3QgY2FyZFByZXZpZXdDYXB0aW9uID1cbiAgcHJvZmlsZVByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19oZWFkaW5nXCIpO1xuXG4vLyBGb3JtIERhdGFcbmV4cG9ydCBjb25zdCBwcm9maWxlSW5wdXROYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1pbnB1dC1uYW1lXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVJbnB1dERlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjbW9kYWwtaW5wdXQtZGVzY3JpcHRpb25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlSW5wdXRQbGFjZSA9XG4gIHByb2ZpbGVBZGRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtcGxhY2VcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZUlucHV0TGluayA9XG4gIHByb2ZpbGVBZGRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW5wdXQtbGlua1wiKTtcblxuLy8gVmFsaWRhdGlvbiBzZXR0aW5nc1xuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9pbmFjdGl2ZVwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXG59O1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5pbXBvcnQge30gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKVxuICAgICk7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcy5faW5wdXRWYWx1ZXM7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5fc3VibWl0SGFuZGxlcik7XG4gICAgdGhpcy5fc3VibWl0SGFuZGxlciA9IChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH07XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5fc3VibWl0SGFuZGxlcik7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IHtcbiAgaW5pdGlhbENhcmRzLFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIGNhcmRUZW1wbGF0ZSxcbiAgcHJvZmlsZUVkaXRNb2RhbCxcbiAgcHJvZmlsZUFkZE1vZGFsLFxuICBwcm9maWxlUHJldmlld01vZGFsLFxuICBwcm9maWxlRWRpdEZvcm0sXG4gIHByb2ZpbGVBZGRGb3JtLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbiAgcHJvZmlsZUVkaXRCdXR0b25DbG9zZSxcbiAgcHJvZmlsZUFkZEJ1dHRvbixcbiAgcHJvZmlsZUFkZEJ1dHRvbkNsb3NlLFxuICBwcm9maWxlUHJldmlld0J1dHRvbkNsb3NlLFxuICBwcm9maWxlTmFtZSxcbiAgcHJvZmlsZURlc2NyaXB0aW9uLFxuICBjYXJkUHJldmlld0ltYWdlLFxuICBjYXJkUHJldmlld0NhcHRpb24sXG4gIHByb2ZpbGVJbnB1dE5hbWUsXG4gIHByb2ZpbGVJbnB1dERlc2NyaXB0aW9uLFxuICBwcm9maWxlSW5wdXRQbGFjZSxcbiAgcHJvZmlsZUlucHV0TGluayxcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuLy8gaW1wb3J0IHsgY3JlYXRlIH0gZnJvbSBcImxvZGFzaFwiO1xuLy8gaW1wb3J0IHsgcHJvZmlsZSB9IGZyb20gXCJjb25zb2xlXCI7XG5cbi8vIEZPUk0gVkFMSURBVElPTiBJTklUXG5jb25zdCBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBwcm9maWxlRWRpdEZvcm1cbik7XG5jb25zdCBwcm9maWxlQWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVBZGRGb3JtXG4pO1xuXG5wcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xucHJvZmlsZUFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG4vLyBVU0VSIElORk8gSU5JVFxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBuYW1lU2VsZWN0b3I6IHByb2ZpbGVOYW1lLFxuICBqb2JTZWxlY3RvcjogcHJvZmlsZURlc2NyaXB0aW9uLFxufSk7XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KCkge1xuICBjb25zb2xlLmxvZyhcIkVkaXQgZm9ybSBzdWJtaXQgaGFuZGxlciBjYWxsZWRcIik7IC8vIEFkZCB0aGlzIGxpbmVcbiAgY29uc29sZS5sb2coXCJOYW1lOlwiLCBwcm9maWxlSW5wdXROYW1lLnZhbHVlKTtcbiAgY29uc29sZS5sb2coXCJEZXNjcmlwdGlvbjpcIiwgcHJvZmlsZUlucHV0RGVzY3JpcHRpb24udmFsdWUpO1xuICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgbmFtZTogcHJvZmlsZUlucHV0TmFtZS52YWx1ZSxcbiAgICBqb2I6IHByb2ZpbGVJbnB1dERlc2NyaXB0aW9uLnZhbHVlLFxuICB9KTtcbiAgcHJvZmlsZUVkaXRGb3JtLnJlc2V0KCk7XG4gIHByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgcHJvZmlsZUVkaXRQb3B1cC5jbG9zZSgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRGb3JtU3VibWl0KCkge1xuICBjb25zdCBkYXRhID0ge1xuICAgIHBsYWNlOiBwcm9maWxlSW5wdXRQbGFjZS52YWx1ZSxcbiAgICBsaW5rOiBwcm9maWxlSW5wdXRMaW5rLnZhbHVlLFxuICAgIGFsdDogYEltYWdlIG9mICR7cHJvZmlsZUlucHV0UGxhY2UudmFsdWV9YCxcbiAgfTtcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xuICBDYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgcHJvZmlsZUFkZEZvcm0ucmVzZXQoKTtcbiAgcHJvZmlsZUFkZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIHByb2ZpbGVBZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgcHJvZmlsZUFkZFBvcHVwLmNsb3NlKCk7XG59XG5cbi8vIFBPUFVQIElOSVRcbmNvbnN0IHByb2ZpbGVFZGl0UG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZUVkaXRGb3JtU3VibWl0XG4pO1xuXG5jb25zdCBwcm9maWxlQWRkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1hZGQtbW9kYWxcIixcbiAgaGFuZGxlQWRkRm9ybVN1Ym1pdFxuKTtcblxuY29uc3QgcHJvZmlsZVByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNwcm9maWxlLXByZXZpZXctbW9kYWxcIik7XG5cbnByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbnByb2ZpbGVBZGRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xucHJvZmlsZVByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBTRUNUSU9OIElOSVRcbmNvbnN0IENhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gIHtcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuICAgICAgQ2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIlxuKTtcblxuLy8gQ1JFQVRFIENBUkRcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwgXCIjY2FyZC10ZW1wbGF0ZVwiLCBoYW5kbGVJbWFnZUNsaWNrKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG4vLyBJTUFHRSBDTElDSyBIQU5ETEVSXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGxpbmssIGFsdCwgcGxhY2UpIHtcbiAgcHJvZmlsZVByZXZpZXdQb3B1cC5vcGVuKGxpbmssIGFsdCwgcGxhY2UpO1xufVxuXG4vLyBFVkVOVCBMSVNURU5FUlNcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgY29uc29sZS5sb2coXCJFZGl0IEJ1dHRvbiBDbGlja2VkIC0gVXNlciBEYXRhOlwiLCB1c2VyRGF0YSk7XG5cbiAgcHJvZmlsZUlucHV0TmFtZS52YWx1ZSA9IHVzZXJEYXRhLm5hbWU7XG4gIHByb2ZpbGVJbnB1dERlc2NyaXB0aW9uLnZhbHVlID0gdXNlckRhdGEuam9iO1xuXG4gIHByb2ZpbGVFZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZUVkaXRQb3B1cC5vcGVuKCk7XG59KTtcblxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwcm9maWxlQWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcbiAgcHJvZmlsZUFkZEZvcm0ucmVzZXQoKTtcbiAgcHJvZmlsZUFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICBwcm9maWxlQWRkUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIC8vIEluaXRpYWwgcmVuZGVyXG5DYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcblxuICAgIC8vIC8vIERlYnVnZ2luZ1xuICAgIC8vIGNvbnNvbGUubG9nKFwiVXNlckluZm8gQ29uc3RydWN0b3I6XCIpO1xuICAgIC8vIGNvbnNvbGUubG9nKFwiTmFtZSBFbGVtZW50OlwiLCB0aGlzLl9uYW1lRWxlbWVudCk7XG4gICAgLy8gY29uc29sZS5sb2coXCJKb2IgRWxlbWVudDpcIiwgdGhpcy5fam9iRWxlbWVudCk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgfTtcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcbiAgICAvLyBjb25zb2xlLmxvZyhcIlNldHRpbmcgdXNlciBpbmZvOlwiLCBuYW1lLCBqb2IpO1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xuXG4gICAgLy8gLy8gRGVidWdnaW5nXG4gICAgLy8gY29uc29sZS5sb2coXCJVcGRhdGVkIE5hbWUgRWxlbWVudDpcIiwgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQpO1xuICAgIC8vIGNvbnNvbGUubG9nKFwiVXBkYXRlZCBKb2IgRWxlbWVudDpcIiwgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX3BsYWNlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9faGVhZGluZ190eXBlX3ByZXZpZXdcIlxuICAgICk7XG4gIH1cblxuICBvcGVuKGxpbmssIGFsdCwgcGxhY2UpIHtcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xuICAgIHRoaXMuX2ltYWdlLmFsdCA9IGFsdDtcbiAgICB0aGlzLl9wbGFjZS50ZXh0Q29udGVudCA9IHBsYWNlO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwidGhpcyIsIl9wbGFjZSIsInBsYWNlIiwiX2xpbmsiLCJsaW5rIiwiX2FsdCIsImFsdCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfaGFuZGxlRGVsZXRlQnV0dG9uIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicmVtb3ZlIiwiZ2V0VmlldyIsImNhcmRUZW1wbGF0ZSIsImRvY3VtZW50IiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlIiwiY2FyZENhcHRpb24iLCJzcmMiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvbiIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJhZGQiLCJpbnB1dEVycm9yQ2xhc3MiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVycm9yQ2xhc3MiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZUJ1dHRvbiIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJkaXNhYmxlZCIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJyZXNldFZhbGlkYXRpb24iLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9oYW5kbGVNb3VzZURvd24iLCJfaGFuZGxlTW91c2VVcCIsIl9pc01vdXNlRG93bk9uTW9kYWwiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJrZXkiLCJ0YXJnZXQiLCJjb250YWlucyIsInNldEV2ZW50TGlzdGVuZXJzIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVBZGRNb2RhbCIsInByb2ZpbGVQcmV2aWV3TW9kYWwiLCJwcm9maWxlRWRpdEZvcm0iLCJwcm9maWxlQWRkRm9ybSIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUFkZEJ1dHRvbiIsInByb2ZpbGVJbnB1dE5hbWUiLCJwcm9maWxlSW5wdXREZXNjcmlwdGlvbiIsInByb2ZpbGVJbnB1dFBsYWNlIiwicHJvZmlsZUlucHV0TGluayIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVzIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJfc3VibWl0SGFuZGxlciIsInJlc2V0IiwicHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yIiwicHJvZmlsZUFkZEZvcm1WYWxpZGF0b3IiLCJ1c2VySW5mbyIsIl9yZWYiLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiZ2V0VXNlckluZm8iLCJqb2IiLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwicHJvZmlsZUVkaXRQb3B1cCIsImNvbnNvbGUiLCJsb2ciLCJwcm9maWxlQWRkUG9wdXAiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJDYXJkU2VjdGlvbiIsImFkZEl0ZW0iLCJwcm9maWxlUHJldmlld1BvcHVwIiwiX2ltYWdlIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwidXNlckRhdGEiXSwic291cmNlUm9vdCI6IiJ9